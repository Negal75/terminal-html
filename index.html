<!DOCTYPE html>
<html>
<head>
<title>Bash Terminal</title>
<style>
  body {
    font-family: monospace, monospace;
    background-color: #000;
    color: #fff;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }

  #terminal {
    width: 100%;
    height: 100vh;
    box-sizing: border-box;
    padding: 20px;
    overflow-y: auto;
    position: relative;
  }

  #terminal-output {
    white-space: pre-wrap;
    margin-bottom: 20px;
  }

  .prompt {
    color: #4CAF50;
  }

  #terminal-input {
    background-color: transparent;
    border: none;
    color: #fff;
    font-family: monospace, monospace;
    font-size: 1em;
    outline: none;
    width: 100%;
    position: absolute;
    bottom: 20px;
    left: 20px;
  }

  .cursor {
    display: inline-block;
    width: 8px;
    height: 1em;
    background-color: #fff;
    animation: blink-caret 1s steps(5, start) infinite;
  }

  @keyframes blink-caret {
    from, to { background-color: transparent; }
    50%  { background-color: #fff; }
  }
</style>
</head>
<body>

<div id="terminal">
  <div id="terminal-output">
    <span class="prompt">user@terminal:~$</span>
  </div>
  <input type="text" id="terminal-input" autofocus placeholder="">
</div>

<script>
  const terminalOutput = document.getElementById('terminal-output');
  const terminalInput = document.getElementById('terminal-input');

  // --- Simulated File System ---
  const fileSystem = {
    '/': {  // Root directory
      'home': {
        'user': {
          'documents': {},
          'downloads': {},
          'scripts': {}
        }
      },
      'etc': {
        'passwd': 'user:x:1000:1000:User,,,:/home/user:/bin/bash'
      },
      'bin': {
        'ls': 'function', // Represent executables as 'function' for now
        'cd': 'function',
        'mkdir': 'function',
        'touch': 'function',
        'echo': 'function',
        'cat': 'function',
        'pwd': 'function',
        'rm': 'function',
        'rmdir': 'function'
      }
    }
  };
  let currentWorkingDirectory = '/home/user'; // Start in user's home directory

  // --- Command Functions ---
  function command_help() {
    return `Available commands:
      help    - Show this help message
      echo    - Display a line of text
      date    - Display current date and time
      clear   - Clear the terminal screen
      ls      - List directory contents
      cd      - Change directory
      pwd     - Print working directory
      mkdir   - Create directory
      touch   - Create an empty file
      cat     - Concatenate and display file content
      rm      - Remove file
      rmdir   - Remove directory
    `;
  }

  function command_echo(args) {
    return args.join(' '); // Join arguments with spaces
  }

  function command_date() {
    const now = new Date();
    return now.toLocaleString();
  }

  function command_clear() {
    terminalOutput.innerHTML = '<span class="prompt">user@terminal:~$</span>';
    return ''; // No output to add
  }

  function command_pwd() {
    return currentWorkingDirectory;
  }

  function command_ls(args) {
    let pathToList = args[0] || currentWorkingDirectory; // Path from argument or CWD
    const resolvedPath = resolvePath(pathToList);
    const dir = getDirectory(resolvedPath);

    if (!dir) {
      return `ls: cannot access '${pathToList}': No such file or directory`;
    }

    let output = '';
    const items = Object.keys(dir);
    if (items.length > 0) {
      output = items.join('  '); // List items with spaces
    }
    return output;
  }

  function command_cd(args) {
    if (!args[0]) {
      currentWorkingDirectory = '/home/user'; // Go to home if no arg
      return '';
    }

    const targetPath = args[0];
    const resolvedPath = resolvePath(targetPath);
    const dir = getDirectory(resolvedPath);

    if (dir) {
      currentWorkingDirectory = resolvedPath;
      return '';
    } else {
      return `cd: ${targetPath}: No such file or directory`;
    }
  }

  function command_mkdir(args) {
    if (!args[0]) {
      return 'mkdir: missing operand\nTry \'mkdir --help\' for more information.';
    }
    const dirName = args[0];
    const resolvedPath = resolvePath(dirName);
    const parentPath = getParentPath(resolvedPath);
    const parentDir = getDirectory(parentPath);
    const newDirName = getBaseName(resolvedPath);

    if (!parentDir) {
      return `mkdir: cannot create directory '${dirName}': No such file or directory`;
    }
    if (parentDir[newDirName]) {
      return `mkdir: cannot create directory '${dirName}': File exists`;
    }

    parentDir[newDirName] = {}; // Create new directory (empty object)
    return '';
  }

  function command_touch(args) {
    if (!args[0]) {
      return 'touch: missing file operand\nTry \'touch --help\' for more information.';
    }
    const fileName = args[0];
    const resolvedPath = resolvePath(fileName);
    const parentPath = getParentPath(resolvedPath);
    const parentDir = getDirectory(parentPath);
    const newFileName = getBaseName(resolvedPath);

    if (!parentDir) {
      return `touch: cannot touch '${fileName}': No such file or directory`;
    }

    parentDir[newFileName] = ''; // Create empty file (empty string)
    return '';
  }

  function command_cat(args) {
    if (!args[0]) {
      return 'cat: missing file operand\nTry \'cat --help\' for more information.';
    }
    const filePath = args[0];
    const resolvedPath = resolvePath(filePath);
    const file = getFile(resolvedPath);

    if (!file) {
      return `cat: ${filePath}: No such file or directory`;
    }
    if (typeof file === 'object') { // It's a directory, not a file
      return `cat: ${filePath}: Is a directory`;
    }
    return file; // Return file content
  }

  function command_rm(args) {
    if (!args[0]) {
      return 'rm: missing operand\nTry \'rm --help\' for more information.';
    }
    const filePath = args[0];
    const resolvedPath = resolvePath(filePath);
    const parentPath = getParentPath(resolvedPath);
    const parentDir = getDirectory(parentPath);
    const fileName = getBaseName(resolvedPath);

    if (!parentDir || !parentDir[fileName]) {
      return `rm: cannot remove '${filePath}': No such file or directory`;
    }
    if (typeof parentDir[fileName] === 'object') { // It's a directory, use rmdir
      return `rm: cannot remove '${filePath}': Is a directory`;
    }

    delete parentDir[fileName]; // Delete the file
    return '';
  }

  function command_rmdir(args) {
    if (!args[0]) {
      return 'rmdir: missing operand\nTry \'rmdir --help\' for more information.';
    }
    const dirPath = args[0];
    const resolvedPath = resolvePath(dirPath);
    const parentPath = getParentPath(resolvedPath);
    const parentDir = getDirectory(parentPath);
    const dirName = getBaseName(resolvedPath);
    const dirToRemove = getDirectory(resolvedPath);

    if (!parentDir || !parentDir[dirName]) {
      return `rmdir: failed to remove '${dirPath}': No such file or directory`;
    }
    if (typeof dirToRemove !== 'object') { // It's a file, not a directory
      return `rmdir: failed to remove '${dirPath}': Not a directory`;
    }
    if (Object.keys(dirToRemove).length > 0) { // Directory not empty
      return `rmdir: failed to remove '${dirPath}': Directory not empty`;
    }

    delete parentDir[dirName]; // Delete the directory
    return '';
  }


  // --- File System Utility Functions ---
  function resolvePath(path) {
    if (path.startsWith('/')) { // Absolute path
      return path;
    } else { // Relative path
      const partsCWD = currentWorkingDirectory.split('/').filter(part => part !== '');
      const partsPath = path.split('/').filter(part => part !== '');
      const resolvedParts = [...partsCWD];

      for (const part of partsPath) {
        if (part === '..') {
          resolvedParts.pop(); // Go up one level
        } else if (part !== '.' && part !== '') {
          resolvedParts.push(part);
        }
      }
      return '/' + resolvedParts.join('/');
    }
  }

  function getDirectory(path) {
    let currentDir = fileSystem['/'];
    const parts = path.split('/').filter(part => part !== '');

    for (const part of parts) {
      if (currentDir && currentDir.hasOwnProperty(part) && typeof currentDir[part] === 'object') {
        currentDir = currentDir[part];
      } else {
        return null; // Directory not found
      }
    }
    return currentDir;
  }

  function getFile(path) {
      let currentDir = fileSystem['/'];
      const parts = path.split('/').filter(part => part !== '');
      const fileName = parts.pop(); // Last part is the file name

      for (const part of parts) {
          if (currentDir && currentDir.hasOwnProperty(part) && typeof currentDir[part] === 'object') {
              currentDir = currentDir[part];
          } else {
              return null; // Path to file not found
          }
      }

      if (currentDir && currentDir.hasOwnProperty(fileName)) {
          return currentDir[fileName]; // Return file content or directory object
      } else {
          return null; // File not found
      }
  }


  function getParentPath(path) {
    const parts = path.split('/').filter(part => part !== '');
    if (parts.length <= 1) return '/'; // Parent of root or single level is root
    parts.pop(); // Remove last part to get parent
    return '/' + parts.join('/');
  }

  function getBaseName(path) {
      const parts = path.split('/').filter(part => part !== '');
      return parts.pop() || ''; // Last part is base name, or empty if root
  }


  // --- Event Listener and Command Execution ---
  terminalInput.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
      event.preventDefault();

      const commandLine = terminalInput.value;
      terminalInput.value = '';

      terminalOutput.innerHTML += `<br><span class="prompt">user@terminal:~$</span> ${commandLine}`;

      const parts = commandLine.trim().split(/\s+/); // Split by spaces
      const commandName = parts[0];
      const args = parts.slice(1); // Arguments are after the command

      let commandOutput = '';

      switch (commandName) {
        case 'help':
          commandOutput = command_help();
          break;
        case 'echo':
          commandOutput = command_echo(args);
          break;
        case 'date':
          commandOutput = command_date();
          break;
        case 'clear':
          commandOutput = command_clear();
          break;
        case 'pwd':
          commandOutput = command_pwd();
          break;
        case 'ls':
          commandOutput = command_ls(args);
          break;
        case 'cd':
          commandOutput = command_cd(args);
          break;
        case 'mkdir':
          commandOutput = command_mkdir(args);
          break;
        case 'touch':
          commandOutput = command_touch(args);
          break;
        case 'cat':
          commandOutput = command_cat(args);
          break;
        case 'rm':
          commandOutput = command_rm(args);
          break;
        case 'rmdir':
          commandOutput = command_rmdir(args);
          break;
        case '': // Empty command (just Enter)
          commandOutput = '';
          break;
        default:
          commandOutput = `bash: command not found: ${commandName}`;
      }

      terminalOutput.innerHTML += `<br>${commandOutput}`;
      terminalOutput.scrollTop = terminalOutput.scrollHeight;
    }
  });

  terminalInput.focus();
</script>

</body>
</html>
